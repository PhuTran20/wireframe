<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MIDILANG</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <i class="fas fa-cube"></i>
          <span>MIDILANG</span>
        </div>
        <nav class="header-nav">
          <a href="#home" class="nav-item active">
            <i class="fas fa-home"></i>
            <span>Home</span>
          </a>

          <a href="#support" class="nav-item">
            <i class="fas fa-headset"></i>
            <span>Hỗ trợ</span>
          </a>
        </nav>
      </div>
      <div class="header-right">
        <div class="account-dropdown">
          <button class="account-btn" id="accountBtn">
            <i class="fas fa-user-circle"></i>
            <span>Tài khoản</span>
            <i class="fas fa-chevron-down"></i>
          </button>
          <div class="dropdown-menu" id="dropdownMenu">
            <a href="#" class="dropdown-item">
              <i class="fas fa-user"></i> Profile
            </a>
            <a href="#payment" class="dropdown-item">
              <i class="fas fa-credit-card"></i>
              <span>Thanh toán</span>
            </a>
            <a href="#" class="dropdown-item">
              <i class="fas fa-cog"></i> Settings
            </a>
            <hr />
            <a href="#" class="dropdown-item">
              <i class="fas fa-sign-out-alt"></i> Logout
            </a>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
      <!-- Left Column - Chat Voice Prompt -->
      <div class="left-column" id="leftColumn">
        <div class="chat-container">
          <div class="chat-header">
            <div class="chat-title">
              <i class="fas fa-comments"></i>
              <h3>MIDILANG - Voice Chat Assistant</h3>
            </div>
            <button
              class="toggle-chat-btn"
              id="toggleChatBtn"
              title="Đóng/Mở chat"
            >
              <i class="fas fa-chevron-left"></i>
            </button>
          </div>

          <!-- Chat Messages -->
          <div class="chat-messages" id="chatMessages">
            <div class="message bot-message">
              <div class="message-avatar">
                <i class="fas fa-robot"></i>
              </div>
              <div class="message-content">
                Xin chào! Tôi là trợ lý AI. Hãy nhấn vào micro để bắt đầu mô tả
                dự án của bạn.
              </div>
            </div>
          </div>

          <!-- Voice Input Controls -->
          <div class="voice-controls">
            <div class="voice-input-section">
              <button
                class="mic-btn"
                id="micBtn"
                title="Nhấn để bắt đầu ghi âm"
              >
                <i class="fas fa-microphone"></i>
              </button>
              <div class="voice-info">
                <p class="voice-status" id="voiceStatus">✓ Sẵn sàng ghi âm</p>
                <div class="voice-visualizer" id="voiceVisualizer">
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                  <div class="voice-bar"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Floating toggle button when chat is collapsed -->
      <button
        class="floating-chat-btn"
        id="floatingChatBtn"
        style="display: none"
      >
        <i class="fas fa-comments"></i>
      </button>

      <!-- Right Column - Main Content (Step Flow) -->
      <div class="right-column">
        <div class="step-indicator">
          <div class="step active" data-step="1">
            <div class="step-number">
              <i class="fas fa-edit"></i>
            </div>
            <div class="step-label">Mô tả dự án</div>
            <div class="step-desc">Cho chúng tôi biết bạn cần gì</div>
          </div>
          <div class="step-line"></div>
          <div class="step" data-step="2">
            <div class="step-number">
              <i class="fas fa-calculator"></i>
            </div>
            <div class="step-label">Xác nhận & thanh toán</div>
            <div class="step-desc">Kiểm tra chi phí dự án</div>
          </div>
          <div class="step-line"></div>
          <div class="step" data-step="3">
            <div class="step-number">
              <i class="fas fa-rocket"></i>
            </div>
            <div class="step-label">Tiến độ & Xem thử</div>
            <div class="step-desc">Theo dõi và kiểm tra</div>
          </div>
          <div class="step-line"></div>
          <div class="step" data-step="4">
            <div class="step-number">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="step-label">Hoàn thành</div>
            <div class="step-desc">Đưa website lên internet</div>
          </div>
        </div>

        <!-- Step Content -->
        <div class="step-content">
          <!-- Step 1: Tóm lược kỹ thuật -->
          <div class="step-panel active" id="step1">
            <h2><i class="fas fa-edit"></i> Mô tả dự án của bạn</h2>
            <p class="step-description">
              Hãy cho chúng tôi biết chi tiết về dự án bạn muốn xây dựng. Càng
              rõ ràng, chúng tôi càng hiểu bạn hơn!
            </p>

            <div class="qa-table-legend">
              <h3>Độ rõ ràng của thông tin</h3>
              <div class="legend-items">
                <div class="legend-item">
                  <span class="legend-icon good"
                    ><i class="fas fa-check-circle"></i
                  ></span>
                  <div class="legend-content">
                    <div class="legend-title">Rõ ràng</div>
                    <div class="legend-desc">
                      Thông tin đầy đủ, có thể tiếp tục
                    </div>
                  </div>
                </div>
                <div class="legend-item">
                  <span class="legend-icon warning"
                    ><i class="fas fa-exclamation-triangle"></i
                  ></span>
                  <div class="legend-content">
                    <div class="legend-title">Mơ hồ vừa</div>
                    <div class="legend-desc">Nên bổ sung thêm chi tiết</div>
                  </div>
                </div>
                <div class="legend-item">
                  <span class="legend-icon danger"
                    ><i class="fas fa-times-circle"></i
                  ></span>
                  <div class="legend-content">
                    <div class="legend-title">Cần chỉnh sửa</div>
                    <div class="legend-desc">Click vào câu để sửa lại</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="project-description-editor">
              <div class="editor-header">
                <i class="fas fa-file-alt"></i>
                <h3>Mô tả dự án của bạn</h3>
              </div>
              <div class="editor-content" id="qaTextEditor">
                <p class="editor-placeholder">
                  Câu trả lời của bạn sẽ được hiển thị ở đây dưới dạng đoạn văn.
                  Những phần được tô màu là những câu cần bổ sung thêm thông
                  tin. Click vào để chỉnh sửa bằng voice chat.
                </p>
              </div>
            </div>

            <div class="qa-list" id="qaList" style="display: none">
              <!-- Q&A items will be added dynamically (hidden) -->
            </div>

            <div class="step-actions">
              <button
                class="btn-end-chat"
                id="endChatBtn"
                style="display: none"
              >
                <i class="fas fa-times-circle"></i> Kết thúc trò chuyện
              </button>
              <div class="step-actions-right">
                <button
                  class="btn-secondary"
                  id="summaryBtn"
                  style="display: none"
                >
                  <i class="fas fa-file-alt"></i> Tóm tắt nội dung
                </button>
                <button class="btn-next" id="nextStep1" style="display: none">
                  <i class="fas fa-arrow-right"></i> Bước tiếp theo
                </button>
              </div>
            </div>
          </div>

          <!-- Step 2: Tóm tắt & Báo giá -->
          <div class="step-panel" id="step2">
            <h2><i class="fas fa-wallet"></i> Báo giá dự án của bạn</h2>
            <p class="step-description">
              Dựa trên những thông tin bạn chia sẻ, đây là chi phí ước tính để
              biến ý tưởng của bạn thành hiện thực.
            </p>

            <!-- Project Summary Recap -->
            <div class="project-recap" id="projectRecap">
              <div class="recap-header">
                <i class="fas fa-info-circle"></i>
                <h3>Tóm tắt dự án</h3>
              </div>
              <div class="recap-content" id="recapContent">
                <!-- Will be filled from Step 1 summary -->
              </div>
            </div>

            <!-- Work Breakdown by Summary Sections -->
            <div class="cost-breakdown-natural">
              <h3><i class="fas fa-tasks"></i> Chúng tôi sẽ làm gì cho bạn</h3>
              <p class="section-desc">
                Dựa trên yêu cầu của bạn, chúng tôi sẽ thực hiện các công việc
                sau:
              </p>

              <div class="cost-sections" id="costSections">
                <!-- Cost sections will be generated based on summary -->
              </div>
            </div>

            <!-- Timeline & Payment Summary Combined -->
            <div class="timeline-payment-section">
              <!-- Left: Timeline -->
              <div class="timeline-info">
                <div class="timeline-header">
                  <i class="fas fa-clock"></i>
                  <h3>Thời gian thực hiện</h3>
                </div>
                <div class="timeline-duration">
                  <div class="duration-number">3</div>
                  <div class="duration-label">ngày làm việc</div>
                </div>
                <div class="timeline-breakdown">
                  <div class="timeline-step">
                    <div class="timeline-step-icon">
                      <i class="fas fa-robot"></i>
                    </div>
                    <div class="timeline-step-info">
                      <strong>AI thiết kế & phát triển</strong>
                      <span>2 ngày</span>
                    </div>
                  </div>
                  <div class="timeline-step">
                    <div class="timeline-step-icon">
                      <i class="fas fa-check-double"></i>
                    </div>
                    <div class="timeline-step-info">
                      <strong>Kiểm tra & triển khai</strong>
                      <span>1 ngày</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Right: Payment Summary (Simple) -->
              <div class="payment-summary-box">
                <div class="payment-header">
                  <i class="fas fa-coins"></i>
                  <h3>Thanh toán</h3>
                </div>

                <div class="payment-breakdown">
                  <div class="payment-item-large" id="paymentDisplay">
                    <!-- Will show either "Miễn phí" or amount to pay -->
                  </div>
                </div>

                <div class="payment-status" id="budgetStatus">
                  <i class="fas fa-spinner fa-spin"></i> Đang tính toán...
                </div>
              </div>
            </div>

            <div class="step-actions step-actions-left">
              <button class="btn-primary" id="proceedBtn" disabled>
                <i class="fas fa-hammer"></i> Xác nhận & Bắt đầu thi công
              </button>
              <button
                class="btn-secondary"
                id="addCreditBtn"
                style="display: none"
              >
                <i class="fas fa-wallet"></i> Thanh toán ngay
              </button>
            </div>
          </div>

          <!-- Step 3: Tiến độ & Xem thử -->
          <div class="step-panel" id="step3">
            <h2>
              <i class="fas fa-rocket"></i> Tiến độ thi công & Xem thử website
            </h2>
            <p class="step-description">
              Chúng tôi đang làm việc cho bạn! Theo dõi tiến độ và xem kết quả
              ngay khi hoàn thành.
            </p>

            <!-- Progress Section -->
            <div class="progress-work-section">
              <h3><i class="fas fa-tasks"></i> Tiến độ thực hiện</h3>
              <div class="work-progress-list" id="workProgressList">
                <!-- Progress items will be generated from Step 2 data -->
              </div>
            </div>

            <!-- Preview Section (will show after progress completes) -->
            <div
              class="preview-section"
              id="previewSection"
              style="display: none"
            >
              <h3><i class="fas fa-eye"></i> Xem thử website của bạn</h3>
              <p class="section-desc">
                Website đã hoàn thành! Hãy xem thử và kiểm tra kỹ trước khi đưa
                lên internet.
              </p>

              <div class="preview-tabs" id="previewTabs">
                <button class="tab-btn active" data-tab="admin">
                  <i class="fas fa-user-shield"></i> Admin
                </button>
                <button class="tab-btn" data-tab="client">
                  <i class="fas fa-user"></i> Client
                </button>
              </div>

              <div class="preview-container">
                <div class="preview-frame" id="previewFrame">
                  <div class="preview-placeholder">
                    <i class="fas fa-desktop"></i>
                    <p>Preview website của bạn sẽ hiển thị ở đây</p>
                  </div>
                </div>
              </div>

              <div class="comment-section">
                <h3>
                  <i class="fas fa-comment-dots"></i> Có điều gì cần chỉnh sửa?
                </h3>
                <textarea
                  id="commentInput"
                  placeholder="Nhập ý kiến của bạn (nếu có)..."
                ></textarea>
                <button class="btn-secondary" id="submitCommentBtn">
                  <i class="fas fa-paper-plane"></i> Gửi yêu cầu chỉnh sửa
                </button>
              </div>
            </div>

            <div class="step-actions step-actions-left">
              <button class="btn-next" id="nextStep3" disabled>
                <i class="fas fa-arrow-right"></i> Hoàn thành & Triển khai
              </button>
            </div>
          </div>

          <!-- Step 4: Hoàn thành -->
          <div class="step-panel" id="step4">
            <h2>
              <i class="fas fa-check-circle"></i> Đưa website lên internet!
            </h2>
            <p class="step-description">
              Mọi thứ đã sẵn sàng! Nhấn nút bên dưới để đưa website của bạn lên
              internet và bắt đầu sử dụng.
            </p>

            <div class="final-preview">
              <div class="preview-info">
                <h3><i class="fas fa-globe"></i> Thông tin website</h3>
                <div class="info-row">
                  <span>Địa chỉ website:</span>
                  <strong id="websiteUrl">Chưa deploy</strong>
                </div>
                <div class="info-row">
                  <span>Trạng thái:</span>
                  <strong id="deployStatus">Sẵn sàng deploy</strong>
                </div>
              </div>
            </div>

            <div class="step-actions">
              <button class="btn-primary" id="deployBtn">
                <i class="fas fa-rocket"></i> Đưa lên internet ngay
              </button>
            </div>

            <div class="deploy-result" id="deployResult" style="display: none">
              <i class="fas fa-check-circle"></i>
              <h3>Chúc mừng! Website đã sẵn sàng!</h3>
              <p>Website của bạn đã được đưa lên internet thành công</p>
              <a href="#" id="deployLink" target="_blank" class="btn-primary">
                <i class="fas fa-external-link-alt"></i> Mở website của tôi
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for Summary -->
    <div class="modal" id="summaryModal">
      <div class="modal-content">
        <span class="close-modal" onclick="closeSummaryModal()">&times;</span>
        <h2><i class="fas fa-file-alt"></i> Tóm tắt nội dung dự án</h2>
        <p class="modal-subtitle">
          Dựa trên thông tin bạn cung cấp, chúng tôi sẽ xây dựng:
        </p>

        <div class="summary-modal-content">
          <!-- Summary cards -->
          <div class="summary-modal-card">
            <div class="summary-modal-icon">
              <i class="fas fa-shopping-bag"></i>
            </div>
            <div class="summary-modal-text">
              <h4>Loại website</h4>
              <p id="modalSummaryType">Website E-commerce</p>
            </div>
          </div>

          <div class="summary-modal-card">
            <div class="summary-modal-icon">
              <i class="fas fa-cogs"></i>
            </div>
            <div class="summary-modal-text">
              <h4>Tính năng chính</h4>
              <ul id="modalSummaryFeatures">
                <li>Giỏ hàng thông minh</li>
                <li>Thanh toán trực tuyến</li>
              </ul>
            </div>
          </div>

          <div class="summary-modal-card">
            <div class="summary-modal-icon">
              <i class="fas fa-palette"></i>
            </div>
            <div class="summary-modal-text">
              <h4>Thiết kế & Giao diện</h4>
              <p id="modalSummaryDesign">Thiết kế hiện đại, Responsive</p>
            </div>
          </div>

          <div class="summary-modal-card">
            <div class="summary-modal-icon">
              <i class="fas fa-plug"></i>
            </div>
            <div class="summary-modal-text">
              <h4>Tích hợp hệ thống</h4>
              <p id="modalSummaryIntegration">VNPay, Momo</p>
            </div>
          </div>

          <div class="summary-modal-card">
            <div class="summary-modal-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="summary-modal-text">
              <h4>Thời gian thực hiện</h4>
              <p id="modalSummaryTimeline">6-8 tuần</p>
            </div>
          </div>
        </div>

        <div class="summary-modal-qa">
          <h3><i class="fas fa-list"></i> Chi tiết từng câu hỏi</h3>
          <div id="modalQAList">
            <!-- Q&A details will be added here -->
          </div>
        </div>

        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeSummaryModal()">
            Đóng
          </button>
        </div>
      </div>
    </div>

    <!-- Modal for End Chat Summary -->
    <div class="modal" id="endChatModal">
      <div class="modal-content modal-large">
        <span class="close-modal" onclick="closeEndChatModal()">&times;</span>
        <div id="endChatContentSufficient" style="display: none">
          <h2><i class="fas fa-file-contract"></i> Tóm tắt dự án của bạn</h2>
          <p class="modal-subtitle">
            Cảm ơn bạn đã chia sẻ thông tin! Dựa trên cuộc trò chuyện vừa rồi,
            đây là bản tóm tắt chi tiết về dự án mà bạn muốn thực hiện:
          </p>

          <div class="end-chat-summary" id="endChatSummaryContent">
            <!-- Summary will be generated here -->
          </div>

          <div class="modal-actions">
            <button class="btn-secondary" onclick="closeEndChatModal()">
              <i class="fas fa-edit"></i> Quay lại chỉnh sửa
            </button>
            <button class="btn-primary" onclick="proceedFromEndChat()">
              <i class="fas fa-arrow-right"></i> Xem báo giá chi tiết
            </button>
          </div>
        </div>

        <div id="endChatContentInsufficient" style="display: none">
          <h2>
            <i class="fas fa-exclamation-triangle"></i> Cần thêm thông tin
          </h2>
          <p class="modal-subtitle">
            Cảm ơn bạn đã chia sẻ! Tuy nhiên, để chúng tôi có thể tạo ra website
            hoàn hảo cho bạn, chúng tôi cần thêm một số thông tin quan trọng.
          </p>

          <div class="insufficient-summary">
            <h3>
              <i class="fas fa-info-circle"></i> Thông tin bạn đã cung cấp
            </h3>
            <div id="providedInfoSummary" class="provided-info">
              <!-- Summary of provided info -->
            </div>
          </div>

          <div class="missing-questions">
            <h3>
              <i class="fas fa-clipboard-question"></i> Vui lòng trả lời thêm
              các câu hỏi sau
            </h3>
            <p class="missing-desc">
              Hãy nhấn vào nút micro <i class="fas fa-microphone"></i> và trả
              lời từng câu hỏi bên dưới. Bạn chỉ cần nói tự nhiên như khi trò
              chuyện, chúng tôi sẽ hiểu và ghi nhận.
            </p>
            <div id="missingQuestionsList" class="missing-questions-list">
              <!-- Missing questions will be listed here -->
            </div>
          </div>

          <div class="modal-actions">
            <button class="btn-primary" onclick="closeEndChatModal()">
              <i class="fas fa-microphone"></i> Tiếp tục trả lời
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for Payment -->
    <div class="modal" id="creditModal">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2><i class="fas fa-credit-card"></i> Thanh toán dự án</h2>
        <p>Vui lòng thanh toán để bắt đầu thi công dự án:</p>
        <div class="credit-topup-info">
          <div class="info-item">
            <span>Số tiền cần thanh toán:</span>
            <strong id="creditNeeded">0 đ</strong>
          </div>
        </div>
        <div class="payment-methods">
          <h4>Chọn phương thức thanh toán:</h4>
          <button class="payment-method-btn">
            <i class="fas fa-credit-card"></i> Thẻ tín dụng/Ghi nợ
          </button>
          <button class="payment-method-btn">
            <i class="fas fa-mobile-alt"></i> Ví điện tử (Momo, ZaloPay)
          </button>
          <button class="payment-method-btn">
            <i class="fas fa-university"></i> Chuyển khoản ngân hàng
          </button>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" id="cancelTopup">Hủy</button>
          <button class="btn-primary" id="confirmTopup">
            Xác nhận thanh toán
          </button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
